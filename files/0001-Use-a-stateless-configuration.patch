From 911d404d0aeae1566aea49c05e711632438c7554 Mon Sep 17 00:00:00 2001
From: Justin Zobel <justin.zobel@gmail.com>
Date: Wed, 4 Sep 2019 11:57:27 +0930
Subject: [PATCH] Use-a-stateless-configuration

---
 src/Makefile.am | 2 +-
 src/rcfile.c    | 6 +++++-
 2 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/src/Makefile.am b/src/Makefile.am
index 625434c..e9d1490 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -1,5 +1,5 @@
 AM_CPPFLAGS = -DLOCALEDIR=\"$(localedir)\" -DSYSCONFDIR=\"$(sysconfdir)\" \
-	-I$(top_builddir)/lib -I$(top_srcdir)/lib
+    -DDATADIR=\"$(datadir)\" -I$(top_builddir)/lib -I$(top_srcdir)/lib
 
 CLEANFILES = revision.h
 
diff --git a/src/rcfile.c b/src/rcfile.c
index d95d154..4b97765 100644
--- a/src/rcfile.c
+++ b/src/rcfile.c
@@ -1311,7 +1311,11 @@ void do_rcfiles(void)
 	const char *xdgconfdir;
 
 	/* First process the system-wide nanorc, if it exists and is suitable. */
-	nanorc = mallocstrcpy(nanorc, SYSCONFDIR "/nanorc");
+	if (access(SYSCONFDIR "/nanorc", F_OK) == 0) {
+		nanorc = mallocstrcpy(nanorc, SYSCONFDIR "/nanorc");
+	} else {
+		nanorc = mallocstrcpy(nanorc, DATADIR "/defaults/nano/nanorc");
+	}
 	if (is_good_file(nanorc))
 		parse_one_nanorc();
 
-- 
2.23.0

